language: ruby
cache: true
archive: true
rvm: 
  - 2.1.2
install:
  - bundle install
  - npm install
  - cd _assets; bower install ; cd ..
script:
  - jekyll serve --full-rebuild --detach
  - node_modules/jshint/bin/jshint _assets/js/
  # Run scss check, but do not fail the build on warnings
  # - scss-lint _assets/css/*.scss ; true
  #- htmlproof --checks-to-ignore=LinkCheck --check-favicon _site
after_script:
  - pkill -f jekyll
after_success:
  - sftp -i ~/.ssh/project_rsa -b sftp_file sqroot_web@watchtower.sqroot.eu
  - mv _site shippable
  - curl -X POST "https://fleep.io/hook/u50gdD1kTPmCrsLzGDsrqA" -d 'message=Sqroot+deployed'
branches:
  only:
    - master
    - develop
